# Atcoder Beginner Contest 227

## E. Swap
Treat $N=|S|$. An upper bound on the answer is $1+2+\dots{+N}$, as if we assume that we're building the final string letter by letter, then we can get any letter to the first position of the string in at most $N$ moves, then $N-1$ moves for the second position, and so on. For any position, if we want a specific letter there, then it's always optimal to move the earliest occurence of that letter in the remaining portion of the string. Note that after moving it, the relative order of the rest of the letters will not have changed.

So, let $dp[m][k][e][y]$ be the amount of ways to construct a string in $m$ moves, with $k$ K's, $e$ E's, and $y$ Y's. For any dp state, it can be said that we have already selected $k+e+y$ letters, so we can try adding each character in the $(k+e+y+1)th$ position. Assume we're adding a $K$; now we have to figure out how many swaps it takes. We know it's optimal to pick the first instance of $K$ in the remaining string, which is the $(k+1)th$ instance of $K$ in the entire string. Using this, we can find how many instances of $E$ and $Y$ are before the occurence of $K$ ($e'$ and $y'$), which, because the relative order of letters doesn't change, means that there exist $max(0,e'-e)+max(0,y'-y)$ other letters between the end of our current string and the first occurence of $K$ in the remaining string. This therefore corresponds to the amount of swaps it takes to move $K$ to the end of our current string. It runs in $O(|S|^5)$.