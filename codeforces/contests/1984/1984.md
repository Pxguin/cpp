# Codeforces Global Round 26 (#1984)

## D. "a" String Problem

First the constraint "there must be at least one copy of <i>t</i>" only applies when the string consists of all a's, so we just put that into a special case: if the string consists of all a's then the answer is just $N-1$, where $N$ is the length of string $s$. 

This means that we can also guarantee that all strings must contain the non-'a' characters. In fact, if we isolate $s$ to only the non-'a' characters (string $s_1$, I guess), then the non-'a' characters appearing in string $t$ must be some prefix of $s_1$. So we can check all prefixes. For a given prefix of size $M$, we can just brute-force check if the next $M$ characters in $s_1$ form an identical string in $s$ with string hashing. This will take worst-case $O(NlogN)$ time because harmonic series. Also, we can speed this up to $O({\sqrt {N_1}})$ (size of $s_1$) because we know that $N_1$ must divide $M$.

If a string passes all these contraints, then we must do math to figure out how many we need to add to the answer. Obviously, our current string must start and end with a non-'a' character, but the actual string doesn't have to. By storing the minimum number of a's between the end and start of adjacent copies of the string (infinity if there is only one copy), and the amount of a's in the prefix and suffix of $s$, we can find out how many total valid strings there are. This is a bit vague but the question is: Given integers $X$, $Y$, $pref$, $suff$, and $min$, find the sum of the products of all pairs $A$ and $B$ such that $A<=X, A<=pref, B<=Y, B<=suff$, and $A+B<=min$. The editorial solution makes this part much easier by fixing the suffix as well (thus, the start of the current string starts with a non-'a' character, but doesn't have to end with one, although this means you can't check in $O({\sqrt {N_1}})$ anymore).