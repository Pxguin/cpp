# Codeforces Round 852 (#1793)

## E. Velepin and Marketing
First, the readers we satisfy should optimally be a prefix of the sorted array. To answer all queries efficiently, we want to calculate, for each prefix, the maximum number of books that can be written such that this prefix can still be satisfied (this lets you find the max amount of readers that can be satisfied for each quantity of books, because if the max is $x$ then the prefix works for all numbers $\le{x}$). Solve using dp, $dp[i]$ equals to the maximum number of groups in a partition of the prefix up to (and including) $i$, such that all readers are satisfied. The remaining $N-i$ readers can each be distributed to individual books.

When calculating $dp[i]$, we know that if $dp[i]-i\ge{0}$ then a valid partition is possible, and otherwise it isn't. If it's possible, then try all possible formations of the last group, so $dp[i] = 1+max(dp[0],dp[1]\dots dp[i-1])$. So, the maximum amount of books for the prefix $i$ will optimally be $dp[i]+(N-i)$. If a partition isn't possible then we can only satisfy this prefix by combining the first $a[i]$ readers into one group; thus, the max amount of books is $1+(N-a[i])$. Sorting results in an $O(NlogN+Q)$ time complexity.