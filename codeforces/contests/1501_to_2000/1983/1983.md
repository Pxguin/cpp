# Codeforces Round 956 (#1983)

## F. array-value
Binary search on the minimum answer $X$ such that there are $\ge K$ subarrays with value $\le X$. We will then find for all $i$ how many subarrays work in the range $[i,n]$. First iterate over $i$ in descending order. Then the easiest way to calculate this is to binary search again on the minimum index $r_i$, such that $a[i]\oplus{a[j]} \le X$ for $i<j\le{r}$ - this can be computed with a trie. Binary search works because if a given $r$ works, then $r+1$ will also work. Then take the minimum index $r_i$ over all $i$ that you have considered, and $N-r$ is the amount of subarrays that work. 

This runs in $O(Nlog^3N)$ which times out. However, we can speed it up to $O(Nlog^2N)$ by avoiding the second binary search. This is because the minimum $r_i$ will monotonically decrease (at most $N$ times), so we can just keep track of the minimum and decrement it while $a[i]\oplus{a[j]} \le X$ for $i<j\le{min r_i}$. The time limit is still pretty tight though, and I had to make a couple extra optimizations to get it within TL.