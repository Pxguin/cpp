# COCI 2020/2021 Contest 3

## 3. Sateliti
The underlying algorithm is very simple: iterate over all $NM$ possible row and column shifts and lexicographically compare them to the answer.

An optimization to make it easier is to paste the grid to get $4$ copies of it, such that the final grid is of size $2N*2M$. Although it's possible to do it without, this simplifies things because we can just search for the lexographically minimum $NM$ subgrid. Also, to compare lexicographical order, just binary search on the earliest position that the two hashes are different, and then manually compare the characters at those positions.

Computing hashes is another issue, and the main difficulty of this problem for me: instead of standard 1d hashes you have to compute 2d hashes. Extension to 2d requires complete understanding of how polynomial hashes work â€” I would read the [cp-algorithms page](https://cp-algorithms.com/string/string-hashing.html#fast-hash-calculation-of-substrings-of-given-string) for more info (especially the second method in fast hash calculation). Here is how it works: instead of using one base we use two unique ones, $p$ and $q$. Cell $i,j$ has a hash value of $S_{i,j}p^iq^j$, and then make a 2d prefix sum array to retrieve the hash of any subgrid (multiplied by some excess power of $p$ and of $q$). When comparing two subgrids of the same size, equate the maximum powers of $p$ and $q$ by multiplying powers of $p$ and $q$ to the hashes that have lower exponents. Then it is easy to check if they are equal by comparing the new hash values.