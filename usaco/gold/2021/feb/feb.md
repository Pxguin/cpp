# USACO Gold 2021 Feb

## 1. Stone Game
Let the initial amount of stones Bessie removes be $x$. Now define $b_i=\lfloor{a_i/x}\rfloor$. Removing $x$ stones from a pile is the same as subtracting $1$ from any pile. Then, the losing state is if all unique $b_i$ occur an even number of times. We can say that Bessie can mirror Elsie's moves, and thus Elsie will never win. The inverse is also true, where if some $b_i$ occurs an odd number of times, then Elsie can just remove the entirety of one of those piles on her first move, and now Bessie is in the losing position because all remaining unique $b_i$ have even frequency. 

Therefore, we are just to count the number of pairs $(i,x)$ such that after calculating all $b$ values by utilizing $a$ and $x$, and subtracting $1$ from $b_i$, all frequencies are even. Go through each $x$ and calculate the frequency and parity of each possible $b_i$ value (with prefix sums, as all numbers in the range $(vx,(v+1)x-1)$ produce a $b_i$ value of $v$). Some basic casework now suffices to determine the piles that Bessie can remove from to guarantee a win. In total, the time complexity is $O(N+(\max{a_i})log(\max{a_i}))$.

The casework: if there is only one $b_i$ with an odd frequency, then it must be $1$. Otherwise, subtracting $1$ displaces some other $b_i$ value and makes it odd. Also, if there's two $b_i$ with odd frequency, then they must be one apart. This is because you can subtract $1$ from the larger $b_i$ and make both values even. In any other case, there are no piles that Bessie can remove from in order to win.