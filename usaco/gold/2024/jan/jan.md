# USACO Gold 2024 January

## 1. Walking in Manhattan
Yeah I solved 90% of this problem in 30 minutes and the other 10% took me like four hours, and debugged a silly typo-caused error for 1 hour. So not entirely sure how hard this problem is; could be anywhere from 2300-2600 on CF imo. Still I think this is an awesome problem.

For simplicity I'll start with subtask 2: $N,Q <= 3000$. If our initial location isn't at an intersection of roads we'll move it there and then find which direction we go in. Also, if this distance is $>= D$, then just backtrack and we have our answer. Otherwise, we should observe that we change directions at the first intersection an odd distance away from our starting intersection, and this pattern continues throughout the path. So, let's find for each road the earliest road such that it's an odd distance away from this one, and then from the starting intersection just follow those indices to build our path. In other words, we have a starting intersection $X$, then we go to the nearest road an odd distance away, $Y$, then repeat for $Y$, etc. until the total distance is $>= D$. Then we can just subtract to get back to $D$ distance traveled. Because each path is at most $2N$ roads, meaning we iterate through $2N$ elements, the total runtime is $O(NQ)$.

To optimize the runtime we should isolate the path into its horizontal and vertical components. We can figure out how many roads we travel in the $H$ and $V$ directions separately, then combine our answers. So if we store separate lists for $H$ and $V$ roads where each road is followed by its nearest odd-distance road, then from any given road we can calculate where we end up if we travel along $X$ roads in the $H/V$ direction from here. Now, observe that multiple roads can have the same nearest odd-distance road, so to break ties we'll take the earliest road and combine the rest into it (this is the single thing that took me 2 hours). From here we'll just binary search on the amount of roads, $X$, and find the lowest $X$ such that the distance traveled is $>= D$. The cow must alternate between $H$ and $V$ roads so we can compute how many roads of each type we walk on. $O(N)$ preprocessing, and an $O(logN)$ binary search with an $O(1)$ check function, so the total runtime is $O(N+QlogN)$.